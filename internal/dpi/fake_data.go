package dpi

// DefaultFakeTLS is a realistic-looking TLS 1.2 ClientHello payload used for
// fake packet injection. It includes common cipher suites and extensions to
// appear legitimate to DPI middleboxes while being rejected by the real server
// (because the packet expires due to low TTL).
//
// This is used when the user hasn't provided a custom fake payload and the
// parsed strategy doesn't include one.
var DefaultFakeTLS = []byte{
	// TLS record header.
	0x16,       // ContentType: Handshake
	0x03, 0x01, // Version: TLS 1.0 (compat)
	0x00, 0xF1, // Length: 241 bytes

	// Handshake: ClientHello.
	0x01,             // HandshakeType: ClientHello
	0x00, 0x00, 0xED, // Length: 237

	0x03, 0x03, // ClientVersion: TLS 1.2

	// Random (32 bytes).
	0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
	0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
	0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
	0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F,

	// Session ID (32 bytes).
	0x20, // Length: 32
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

	// Cipher suites (22 bytes = 11 suites).
	0x00, 0x16,
	0x13, 0x01, // TLS_AES_128_GCM_SHA256
	0x13, 0x02, // TLS_AES_256_GCM_SHA384
	0x13, 0x03, // TLS_CHACHA20_POLY1305_SHA256
	0xC0, 0x2B, // TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
	0xC0, 0x2F, // TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
	0xC0, 0x2C, // TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
	0xC0, 0x30, // TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
	0xCC, 0xA9, // TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305
	0xCC, 0xA8, // TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305
	0x00, 0x9E, // TLS_DHE_RSA_WITH_AES_128_GCM_SHA256
	0x00, 0xFF, // TLS_EMPTY_RENEGOTIATION_INFO_SCSV

	// Compression methods.
	0x01, 0x00, // 1 method: null

	// Extensions.
	0x00, 0x88, // Extensions length: 136

	// SNI extension with a fake hostname.
	0x00, 0x00, // Type: server_name
	0x00, 0x13, // Length: 19
	0x00, 0x11, // Server name list length: 17
	0x00,       // Host name type
	0x00, 0x0E, // Host name length: 14
	0x77, 0x77, 0x77, 0x2E, 0x67, 0x6F, 0x6F, 0x67,
	0x6C, 0x65, 0x2E, 0x63, 0x6F, 0x6D, // "www.google.com"

	// EC Point Formats.
	0x00, 0x0B, // Type
	0x00, 0x04, // Length
	0x03, 0x00, 0x01, 0x02,

	// Supported Groups.
	0x00, 0x0A, // Type
	0x00, 0x0A, // Length
	0x00, 0x08, // List length
	0x00, 0x1D, // x25519
	0x00, 0x17, // secp256r1
	0x00, 0x1E, // x448
	0x00, 0x18, // secp384r1

	// Signature Algorithms.
	0x00, 0x0D, // Type
	0x00, 0x14, // Length
	0x00, 0x12, // List length
	0x04, 0x03, // ecdsa_secp256r1_sha256
	0x08, 0x04, // rsa_pss_rsae_sha256
	0x04, 0x01, // rsa_pkcs1_sha256
	0x05, 0x03, // ecdsa_secp384r1_sha384
	0x08, 0x05, // rsa_pss_rsae_sha384
	0x05, 0x01, // rsa_pkcs1_sha384
	0x08, 0x06, // rsa_pss_rsae_sha512
	0x06, 0x01, // rsa_pkcs1_sha512
	0x02, 0x01, // rsa_pkcs1_sha1

	// Supported Versions.
	0x00, 0x2B, // Type
	0x00, 0x05, // Length
	0x04,       // List length
	0x03, 0x04, // TLS 1.3
	0x03, 0x03, // TLS 1.2

	// Key Share (x25519).
	0x00, 0x33, // Type
	0x00, 0x26, // Length
	0x00, 0x24, // List length
	0x00, 0x1D, // x25519
	0x00, 0x20, // Key length: 32
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

	// ALPN.
	0x00, 0x10, // Type
	0x00, 0x0B, // Length
	0x00, 0x09, // List length
	0x02, 0x68, 0x32, // h2
	0x08, 0x68, 0x74, 0x74, 0x70, 0x2F, 0x31, 0x2E, 0x31, // http/1.1
}
