# AWG Split Tunnel — Example Configuration
# Uses WinTUN gateway adapter + WFP per-process interface blocking.
# No adapter_index needed — traffic is routed via TUN adapter automatically.

# Global IP/app filters (optional).
# Applied to ALL tunnels before per-tunnel filters.
global:
  # Local/private networks (RFC 1918, link-local, multicast, loopback)
  # are automatically excluded from VPN. Set disable_local: true to
  # override this and route ALL traffic (including local) through VPN.
  # disable_local: true

  # Additional IPs that always bypass VPN (go direct). Checked before AllowedIPs.
  # Bare IPs (without /mask) are treated as /32.
  disallowed_ips:
#    - "192.168.0.0/24"   # Specific server

  # Apps that always go direct (bypass VPN entirely).
  # Same pattern syntax as rules: exe name, substring, path glob, dir\*
  disallowed_apps:
#    - "steam.exe"
#    - 'C:\Games\*'

  # If set, only these IPs go through VPN. Default: all traffic.
  # Omit to route all matched traffic through VPN.
  # allowed_ips:
  #   - "0.0.0.0/0"

  # Kill switch: block ALL non-VPN traffic when VPN is active.
  # Prevents data leaks if VPN disconnects. Default: false.
  # kill_switch: false

tunnels:
#  - id: awg-germany
#    protocol: amneziawg
#    name: "AWG Germany"
#    settings:
#      config_file: "awg-germany.conf"  # Path to AmneziaWG .conf file (required)
      # adapter_ip: "10.8.1.2"         # Optional: override IP from .conf Address

    # Per-tunnel IP/app filters (optional, override global).
    # disallowed_ips:
    #   - "192.168.1.0/24"
    # allowed_ips:
    #   - "0.0.0.0/0"
    # disallowed_apps:
    #   - "qbittorrent.exe"

rules:
  # Route Firefox through the German AWG tunnel, block if tunnel is down (kill switch)
#  - pattern: "firefox.exe"
#    tunnel_id: awg-germany
#    fallback: block

  # Route Chrome through tunnel, allow direct if tunnel is down
#  - pattern: "chrome"
#    tunnel_id: awg-germany
#    fallback: allow_direct

  # Block all traffic from processes in C:\blocked\ directory
#  - pattern: 'C:\blocked\*'
#    fallback: drop

  # Route Steam through tunnel with kill switch
#  - pattern: "steam.exe"
#    tunnel_id: awg-germany
#    fallback: block

  # Discord: realtime priority — voice/video packets skip the bulk queue
#  - pattern: "discord.exe"
#    tunnel_id: awg-germany
#    fallback: block
#    priority: realtime

  # Torrent client: low priority — bulk downloads yield to interactive traffic
#  - pattern: "qbittorrent.exe"
#    tunnel_id: awg-germany
#    fallback: allow_direct
#    priority: low

  # Priority values: auto (default), realtime, normal, low
  # "auto" classifies packets by their characteristics:
  #   - Small UDP (<300 bytes, both ports >=1024) → high (voice/game)
  #   - DNS (port 53) → high
  #   - TCP SYN/FIN/RST → high (per-packet boost)
  #   - Everything else → normal

# DNS routing configuration (optional).
# Controls how DNS queries are routed per-process.
dns:
  # Tunnel for system DNS queries (svchost.exe, unmatched processes).
  # Omit or leave empty to route through direct (system DNS via real NIC).
  tunnel_id: direct

  # DNS servers for fallback queries.
  # If empty, uses the tunnel's built-in DNS servers from WG config.
  # Queries are sent to all servers in parallel; first response wins.
  servers:
    - "1.1.1.1"
    - "8.8.8.8"
    - "9.9.9.9"

  # DNS response cache (optional, enabled by default).
  # Caches upstream DNS responses to avoid redundant queries.
  # cache:
  #   enabled: true      # Set to false to disable caching
  #   max_size: 10000    # Maximum number of cache entries
  #   min_ttl: "30s"     # Minimum TTL floor
  #   max_ttl: "5m"      # Maximum TTL cap
  #   neg_ttl: "60s"     # NXDOMAIN cache TTL

  # FakeIP: synthetic IP allocation for domain-based routing (optional).
  # When enabled, DNS responses for domain-matched queries are rewritten
  # to use IPs from the configured CIDR range (RFC 2544 benchmark range).
  # This prevents browser DNS cache from breaking domain routing rules.
  # fakeip:
  #   enabled: true           # Enable FakeIP rewriting
  #   cidr: "198.18.0.0/15"   # FakeIP address pool (default: 198.18.0.0/15)

# Logging configuration (optional).
# Controls log verbosity globally and per-component.
# Levels: debug, info, warn, error, off (default: info).
# Fatalf always prints regardless of level.
logging:
  level: info
  file_enabled: false  # Write logs to logs/ directory (default: false)
  # Per-component overrides (lowercase component name):
  #   core, gateway, route, wfp, dns, proxy, rule, awg, direct
  # components:
  #   dns: off       # Silence DNS per-query logs
  #   gateway: debug # Verbose gateway/packet logs

# GUI settings (optional).
# gui:
#   restore_connections: true
#   reconnect:
#     enabled: true
#     interval: "5s"
#     max_retries: 0
#   # Peer health monitoring: detects stale WG/AWG peers (expired handshakes)
#   # and triggers automatic reconnection. Enabled by default when reconnect is enabled.
#   # health_check:
#   #   enabled: true          # Override: set false to disable even with reconnect on
#   #   interval: "30s"        # How often to check peer handshake times
#   #   stale_threshold: "3m"  # Max age of last handshake before marking stale

# Auto-update settings (optional).
# Checks GitHub Releases for new versions periodically.
update:
   enabled: true          # Enable periodic update checks (default: true)
   check_interval: "24h"  # How often to check (default: "24h")
